// Файл для сбора описаний фильмов
package main

import (
        "encoding/json"
        "fmt"
        "io/ioutil"
        "path/filepath"
)

// MovieWithDescription расширяет структуру Movie с полным описанием
type MovieWithDescription struct {
        ID          string `json:"id"`
        Title       string `json:"title"`
        Year        int    `json:"year"`
        Category    string `json:"category"`
        Description string `json:"description"`
        ImagePath   string `json:"imagePath"`
        FullDescription string `json:"fullDescription"`
}

func main() {
        // Загружаем существующие данные о фильмах
        jsonFilePath := filepath.Join("static", "data", "movies.json")
        jsonData, err := ioutil.ReadFile(jsonFilePath)
        if err != nil {
                fmt.Printf("Ошибка при чтении JSON файла: %v\n", err)
                return
        }

        // Распаковываем JSON в карту фильмов
        var moviesByCategory map[string][]MovieWithDescription
        err = json.Unmarshal(jsonData, &moviesByCategory)
        if err != nil {
                fmt.Printf("Ошибка при распаковке JSON: %v\n", err)
                return
        }

        // Добавляем описания фильмов
        // Артур, ты король
        if movies, ok := moviesByCategory["drama"]; ok {
                for i, movie := range movies {
                        if movie.ID == "arthur-king" {
                                movies[i].FullDescription = `Фильм "Артур, ты король" основан на реальных событиях. Майкл (Марк Уолберг) — опытный выживальщик и ветеран экстремальных гонок. Три года назад он с командой был близок к победе, но потерпел фиаско, что морально уничтожило его. Теперь он решает попытаться снова и собирает команду для участия в экстремальных гонках в Доминикане. Во время соревнований к команде прибивается бездомный пес, которого они называют Артуром. Именно дружба с этим псом помогает Майклу и его команде пройти сложнейший путь до конца. Фильм рассказывает трогательную историю о дружбе человека и собаки в экстремальных условиях.`
                                movies[i].Description = "История о спортсмене-экстремале, который во время гонки в Доминикане встречает бездомного пса, ставшего его верным другом и помощником."
                        }
                        
                        if movie.ID == "white-bird" {
                                movies[i].FullDescription = `"Белая птица: Новое чудо" - драматический фильм, продолжающий историю, начатую в фильме "Чудо". Действие происходит во время Второй мировой войны во Франции. Еврейский мальчик Джулиан находит убежище в сельской школе, где его прячет от нацистов девочка Сара и её семья. Несмотря на опасность и трудности военного времени, между детьми возникает особая связь. Фильм рассказывает о силе доброты, храбрости и человечности в самые тёмные времена истории.`
                                movies[i].Description = "Драматическая история о еврейском мальчике, скрывающемся от нацистов во Франции во время Второй мировой войны."
                        }
                        
                        if movie.ID == "eternal-sunshine" {
                                movies[i].FullDescription = `"Вечное сияние чистого разума" - психологическая драма с элементами фантастики. После болезненного расставания Джоэл Бэриш (Джим Керри) узнаёт, что его бывшая девушка Клементина (Кейт Уинслет) обратилась в компанию Lacuna Inc., чтобы стереть все воспоминания о их отношениях. Потрясённый этим, Джоэл решает сделать то же самое. Однако во время процедуры стирания памяти, погружаясь в собственные воспоминания, Джоэл понимает, что не хочет забывать Клементину, и пытается сохранить хотя бы часть воспоминаний о ней. Фильм исследует темы памяти, любви и того, что делает отношения значимыми.`
                                movies[i].Description = "Психологическая драма о паре, решившей стереть воспоминания друг о друге после расставания."
                        }
                }
                moviesByCategory["drama"] = movies
        }
        
        // Добавляем описания для фильмов категории "Фантастика и фэнтези"
        if movies, ok := moviesByCategory["fantasy"]; ok {
                for i, movie := range movies {
                        if movie.ID == "interstellar" {
                                movies[i].FullDescription = `"Интерстеллар" - научно-фантастический эпос режиссёра Кристофера Нолана. В недалёком будущем Земля становится непригодной для жизни из-за экологической катастрофы. Бывший пилот NASA Купер (Мэттью МакКонахи) присоединяется к секретной миссии по поиску новой планеты для человечества. Экспедиция проходит через червоточину возле Сатурна, исследуя потенциально обитаемые планеты в другой галактике. Фильм сочетает в себе захватывающие космические приключения с глубокими размышлениями о любви, времени и человеческой природе. Особое внимание уделяется отношениям Купера с его дочерью Мёрф, которую он оставил на Земле ради спасения человечества.`
                                movies[i].Description = "Научно-фантастический фильм о путешествии через червоточину в поисках новой планеты для человечества."
                        }
                        
                        if movie.ID == "inception" {
                                movies[i].FullDescription = `"Начало" - научно-фантастический триллер режиссёра Кристофера Нолана. Доминик Кобб (Леонардо ДиКаприо) - специалист по извлечению информации из подсознания людей во время сна. Ему предлагают необычное задание: не украсть идею, а внедрить её в сознание человека - процесс, известный как "внедрение". Для выполнения этой сложной миссии Кобб собирает команду профессионалов, которые должны создать многоуровневый сон внутри сна. Фильм исследует природу реальности, подсознания и памяти, предлагая зрителю запутанный, но захватывающий сюжет с неоднозначной концовкой.`
                                movies[i].Description = "Научно-фантастический триллер о технологии проникновения в сны людей для кражи или внедрения идей."
                        }
                        
                        if movie.ID == "dune" {
                                movies[i].FullDescription = `"Дюна" - эпическая научно-фантастическая сага режиссёра Дени Вильнёва, экранизация одноимённого романа Фрэнка Герберта. Действие происходит в далёком будущем, где молодой Пол Атрейдес (Тимоти Шаламе) вместе со своей семьёй прибывает на опасную планету Арракис, известную как Дюна. Эта пустынная планета является единственным источником самого ценного вещества во вселенной - "пряности", которая продлевает жизнь и расширяет сознание. Когда семья Атрейдесов становится жертвой предательства, Пол вынужден бежать в пустыню, где его ждёт встреча с коренными жителями планеты - фременами, и начало пути к своему предназначению. Фильм сочетает в себе политические интриги, религиозные мотивы и экологические темы.`
                                movies[i].Description = "Эпическая научно-фантастическая сага о молодом наследнике знатного рода, чья семья получает в управление опасную пустынную планету."
                        }
                }
                moviesByCategory["fantasy"] = movies
        }
        
        // Добавляем описания для фильмов категории "Комедия"
        if movies, ok := moviesByCategory["comedy"]; ok {
                for i, movie := range movies {
                        if movie.ID == "change-up" {
                                movies[i].FullDescription = `"Хочу как ты" (The Change-Up) - комедия о двух друзьях с совершенно разными жизнями. Митч (Райан Рейнольдс) - безответственный холостяк, а Дэйв (Джейсон Бейтман) - успешный юрист, муж и отец троих детей. Однажды ночью, после совместной попойки, они одновременно высказывают желание пожить жизнью друг друга, и на следующее утро обнаруживают, что их сознания поменялись телами. Теперь Митч должен справляться с семейными обязанностями и работой Дэйва, а Дэйв - с беспорядочной жизнью Митча. Эта ситуация приводит к множеству комичных ситуаций, но также заставляет друзей по-новому взглянуть на свои жизни и переоценить свои приоритеты.`
                                movies[i].Description = "Комедия о двух друзьях с противоположными жизнями, которые волшебным образом меняются телами."
                        }
                }
                moviesByCategory["comedy"] = movies
        }
        
        // Добавляем описания для фильмов категории "Триллер и детектив"
        if movies, ok := moviesByCategory["thriller"]; ok {
                for i, movie := range movies {
                        if movie.ID == "catch-me" {
                                movies[i].FullDescription = `"Поймай меня, если сможешь" - биографический криминальный фильм режиссёра Стивена Спилберга, основанный на реальной истории Фрэнка Абигнейла-младшего. В 1960-х годах, ещё будучи подростком, Фрэнк (Леонардо ДиКаприо) становится одним из самых успешных мошенников в истории США. Он мастерски подделывает чеки, выдаёт себя за пилота авиакомпании, врача и адвоката, обманывая людей на миллионы долларов. За ним неустанно следует агент ФБР Карл Хэнрэтти (Том Хэнкс), который постепенно сближается с Фрэнком в ходе этой необычной "игры в кошки-мышки". Фильм сочетает в себе элементы драмы, комедии и триллера, исследуя темы идентичности, отцовства и искупления.`
                                movies[i].Description = "Криминальный триллер, основанный на реальной истории молодого мошенника, за которым охотится агент ФБР."
                        }
                }
                moviesByCategory["thriller"] = movies
        }

        // Сохраняем обновленные данные в JSON файл
        updatedJsonData, err := json.MarshalIndent(moviesByCategory, "", "  ")
        if err != nil {
                fmt.Printf("Ошибка при маршалинге обновленного JSON: %v\n", err)
                return
        }

        if err := ioutil.WriteFile(jsonFilePath, updatedJsonData, 0644); err != nil {
                fmt.Printf("Ошибка при записи обновленного JSON файла: %v\n", err)
                return
        }

        fmt.Println("Описания фильмов успешно добавлены и сохранены в", jsonFilePath)
}
